(()=>{"use strict";class t{constructor(){this.subs=[]}add(t){this.subs.push(t)}notify(){this.subs.forEach((t=>{t.update()}))}}class e{constructor(t){this.data=t,this.walk(t)}walk(t){t&&"object"==typeof t&&Object.keys(t).forEach((e=>{this.defineReactive(t,e,t[e])}))}defineReactive(e,s,i){let n=new t;Object.defineProperty(e,s,{enumerable:!0,configurable:!1,get:()=>(t.target&&n.add(t.target),i),set:t=>{i=t,console.log("set"),n.notify()}}),this.walk(i)}}class s{constructor(t,e,s){this.exp=t,this.scope=e,this.cb=s,this.update()}get(e){t.target=this;let i=s.cal(this.exp,this.scope);return t.target=null,i}static cal(t,e){return new Function("scope","with(scope){return "+t+"}")(e)}update(){let t=this.get(this.exp);this.cb&&this.cb(t)}}class i{constructor(t){this.$el=t.$el,this.vm=t,console.log(this.$el),this.$fragment=this.nodeToFragment(this.$el),this.compile(this.$fragment),this.$el.appendChild(this.$fragment)}nodeToFragment(t){let e=document.createDocumentFragment();return t.childNodes&&t.childNodes.length&&t.childNodes.forEach((t=>{this.ignore(t)||e.appendChild(t)})),e}ignore(t){return 8===t.nodeType||3===t.nodeType&&/^[\t\n\r]+/.test(t.textContent)}compile(t){t.childNodes&&t.childNodes.length&&t.childNodes.forEach((t=>{1===t.nodeType?(this.compileElementNode(t),this.compile(t)):3===t.nodeType&&this.compileElementText(t)}))}compileElementNode(t){[...t.attributes].forEach((e=>{let{name:i,value:n}=e;if(i.indexOf("v-")>-1)switch(i.slice(2)){case"text":new s(n,this.vm,(e=>{t.textContent=e}));break;case"model":new s(n,this.vm,(e=>{t.value=e})),t.addEventListener("input",(t=>{let e=n.split(".");e.reduce(((s,i,n)=>n===e.length-1?s[i]=t.target.value:s[i]),this.vm.$data)}))}}))}compileElementText(t){let e=t.textContent;if(e){let i=this.parseTextContent(e);new s(i,this.vm,(e=>{t.textContent=e}))}}parseTextContent(t){let e=/\{\{(.+?)\}\}/g,s=t.split(e),i=t.match(e),n=[];return s.forEach((t=>{i&&i.indexOf("{{"+t+"}}")>-1?n.push("("+t+")"):n.push("`"+t+"`")})),n.join("+")}}window.Vue=class{constructor(t){this.$el=document.querySelector(t.el),this.$data=t.data,this.proxyData(this.$data),new e(this.$data),new i(this)}proxyData(t){Object.keys(t).forEach((e=>{Object.defineProperty(this,e,{get:()=>t[e],set:s=>{t[e]=s}})}))}}})();